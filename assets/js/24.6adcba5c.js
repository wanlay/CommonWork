(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{165:function(s,t,a){"use strict";a.r(t);var e=a(0),n=Object(e.a)({},(function(){var s=this.$createElement;this._self._c;return this._m(0)}),[function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("div",{staticClass:"content"},[a("h1",{attrs:{id:"lvm扩展硬盘容量"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lvm扩展硬盘容量","aria-hidden":"true"}},[s._v("#")]),s._v(" lvm扩展硬盘容量")]),a("h2",{attrs:{id:"查看硬盘系统分区状态"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看硬盘系统分区状态","aria-hidden":"true"}},[s._v("#")]),s._v(" 查看硬盘系统分区状态")]),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# fdisk -l ")]),s._v("\nDisk /dev/sda: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("500")]),s._v(" GiB, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("536870912000")]),s._v(" bytes, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1048576000")]),s._v(" sectors\nUnits: sectors of "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" * "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes\nSector size "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("logical/physical"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes / "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes\nI/O size "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("minimum/optimal"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes / "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes\nDisklabel type: dos\nDisk identifier: 0x1eb6677b\n\nDevice     Boot   Start       End   Sectors  Size Id Type\n/dev/sda1  *       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2048")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("999423")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("997376")]),s._v("  487M "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("83")]),s._v(" Linux\n/dev/sda2       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1001470")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("167770111")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("166768642")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("79")]),s._v(".5G  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" Extended\n/dev/sda5       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1001472")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("167770111")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("166768640")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("79")]),s._v(".5G 8e Linux LVM\n")])])]),a("p",[s._v("可以看到在vsphere中已经给虚机硬盘扩容的500G已经成功，但是我们还需要给LVM的volume group扩容。")]),a("h2",{attrs:{id:"给新加的硬盘空间建立lvm类型分区"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#给新加的硬盘空间建立lvm类型分区","aria-hidden":"true"}},[s._v("#")]),s._v(" 给新加的硬盘空间建立LVM类型分区")]),a("blockquote",[a("p",[s._v("分区")])]),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# fdisk /dev/sda")]),s._v("\n\n Welcome to "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("fdisk")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("util-linux "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.27")]),s._v(".1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".\nChanges will remain "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" memory only, "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("until")]),s._v(" you decide to "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("write")]),s._v(" them.\nBe careful before using the "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("write")]),s._v(" command.\n\n\nCommand "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("m "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("help")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": p\nDisk /dev/sda: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("500")]),s._v(" GiB, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("536870912000")]),s._v(" bytes, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1048576000")]),s._v(" sectors\nUnits: sectors of "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" * "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes\nSector size "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("logical/physical"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes / "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes\nI/O size "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("minimum/optimal"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes / "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes\nDisklabel type: dos\nDisk identifier: 0x1eb6677b\n\nDevice     Boot   Start       End   Sectors  Size Id Type\n/dev/sda1  *       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2048")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("999423")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("997376")]),s._v("  487M "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("83")]),s._v(" Linux\n/dev/sda2       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1001470")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("167770111")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("166768642")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("79")]),s._v(".5G  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" Extended\n/dev/sda5       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1001472")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("167770111")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("166768640")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("79")]),s._v(".5G 8e Linux LVM\n\nCommand "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("m "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("help")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": n                   \nPartition "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("type")]),s._v("\n   p   primary "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" primary, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" extended, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("free")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  l   logical "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("numbered from "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nSelect "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("default p"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": p\nPartition number "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3,4")]),s._v(", default "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\nFirst sector "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("999424")]),s._v("-1048575999, default "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("999424")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("167770112")]),s._v("\nLast sector, +sectors or +size"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("K,M,G,T,P"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("167770112")]),s._v("-1048575999, default "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1048575999")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": \n\nCreated a new partition "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" of "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("type")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Linux'")]),s._v(" and of size "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("420")]),s._v(" GiB.\n\nCommand "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("m "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("help")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": w\nThe partition table has been altered.\nCalling ioctl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" to re-read partition table.\nRe-reading the partition table failed.: Device or resource busy\n\nThe kernel still uses the old table. The new table will be used at the next "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("reboot")]),s._v(" or after you run partprobe"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" or kpartx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".\n")])])]),a("blockquote",[a("p",[s._v("执行以root用户执行，刷新内核中的分区表")])]),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# partprobe")]),s._v("\n")])])]),a("blockquote",[a("p",[s._v("为新分区建立physical volume")])]),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# pvcreate /dev/sda3")]),s._v("\n")])])]),a("blockquote",[a("p",[s._v("将新pv加入到lvm的VG组")])]),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vgdisplay")]),s._v("\n")])])]),a("p",[s._v("在示例环境中，vg_name为ubuntu-vg")]),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vgextend ubuntu-vg /dev/sda3")]),s._v("\n")])])]),a("blockquote",[a("p",[s._v("刷新pv列表")])]),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# pvscan ")]),s._v("\n")])])]),a("p",[s._v("此时可以看到新的pv已经加入到了ubuntu-vg下")]),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("PV /dev/sda5   VG ubuntu-vg       lvm2 [79.52 GiB / 0    free]\nPV /dev/sda3   VG ubuntu-vg       lvm2 [420.00 GiB / 420.00 GiB free]\nTotal: 2 [499.52 GiB] / in use: 2 [499.52 GiB] / in no VG: 0 [0   ]\n")])])]),a("h2",{attrs:{id:"将pv-dev-sda3划分到root-lv下"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#将pv-dev-sda3划分到root-lv下","aria-hidden":"true"}},[s._v("#")]),s._v(" 将PV /dev/sda3划分到root LV下")]),a("blockquote",[a("p",[s._v("查看root LV的dev path")])]),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# lvdisplay")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#lvextend /dev/ubuntu-vg/root /dev/sda3")]),s._v("\nSize of logical volume ubuntu-vg/root changed from "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("75.52")]),s._v(" GiB "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19333")]),s._v(" extents"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" to "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("495.52")]),s._v(" GiB "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("126853")]),s._v(" extents"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".\nLogical volume root successfully resized.\n")])])]),a("blockquote",[a("p",[s._v("重新加载LV到文件系统")])]),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# resize2fs /dev/ubuntu-vg/root")]),s._v("\n或者 "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  btrfs filesystem resize max /")]),s._v("\nresize2fs "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.42")]),s._v(".13 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v("-May-2015"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nFilesystem at /dev/ubuntu-vg/root is mounted on /"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" on-line resizing required\nold_desc_blocks "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(", new_desc_blocks "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("31")]),s._v("\nThe filesystem on /dev/ubuntu-vg/root is now "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("129897472")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("4k"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" blocks long.\n")])])]),a("blockquote",[a("p",[s._v("查看硬盘使用情况，验证结果")])]),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# df -h")]),s._v("\nFilesystem                   Size  Used Avail Use% Mounted on\nudev                         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(".9G     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(".9G   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("% /dev\ntmpfs                        799M  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(".4M  789M   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("% /run\n/dev/mapper/ubuntu--vg-root  488G   55G  413G  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v("% /\ntmpfs                        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(".9G  300K  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(".9G   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("% /dev/shm\ntmpfs                        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(".0M     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(".0M   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("% /run/lock\ntmpfs                        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(".9G     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(".9G   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("% /sys/fs/cgroup\n/dev/sda1                    472M  170M  278M  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("39")]),s._v("% /boot\n")])])]),a("p",[s._v("可以看到/dev/mapper/ubuntu--vg-root已经扩容到了488G")])])}],!1,null,null,null);t.default=n.exports}}]);